; ============================================================================
; PlatformIO Configuration for Unified Automotive ECU
; Supports multiple automotive MCU platforms
; ============================================================================

[platformio]
default_envs = stm32f407   ; Default to STM32F407 for beginners

; ============================================================================
; COMMON SETTINGS (shared across all platforms)
; ============================================================================
[env]
framework = arduino
build_flags =
    -D ENABLE_SERIAL_DEBUG=1
    -Wall
    -Wextra
lib_deps =
    ; CAN library (platform-specific, defined per environment)

; ============================================================================
; STM32F407 - Recommended for beginners
; ============================================================================
[env:stm32f407]
platform = ststm32
board = nucleo_f407zg        ; or genericSTM32F407VGT6 for bluepill-style boards
board_build.mcu = stm32f407vgt6
board_build.f_cpu = 168000000L

lib_deps =
    ${env.lib_deps}
    stm32duino/STM32duino CAN @ ^1.2.0

build_flags =
    ${env.build_flags}
    -D MCU_PLATFORM=MCU_STM32F407
    -D HAL_CAN_MODULE_ENABLED
    -D HAL_TIM_MODULE_ENABLED
    -D HAL_ADC_MODULE_ENABLED

upload_protocol = stlink     ; ST-Link programmer
debug_tool = stlink
monitor_speed = 115200

; ============================================================================
; TI C2000 F28379D - Best for motor control (EV conversions)
; ============================================================================
[env:c2000]
platform = https://github.com/Andy4495/platform-ti-c2000.git
board = launchxl-f28379d
board_build.mcu = TMS320F28379D
board_build.f_cpu = 200000000L

lib_deps =
    ${env.lib_deps}
    ; C2000 CAN library (TI controlSUITE)

build_flags =
    ${env.build_flags}
    -D MCU_PLATFORM=MCU_TI_C2000
    -D __TMS320F28379D__

upload_protocol = xds110      ; TI XDS110 programmer
debug_tool = xds110
monitor_speed = 115200

; ============================================================================
; NXP S32K148 - True automotive MCU (ISO 26262 capable)
; ============================================================================
[env:s32k148]
platform = nxp_s32
board = s32k148evb           ; S32K148 evaluation board
board_build.mcu = S32K148
board_build.f_cpu = 112000000L

lib_deps =
    ${env.lib_deps}
    ; NXP SDK FlexCAN library

build_flags =
    ${env.build_flags}
    -D MCU_PLATFORM=MCU_NXP_S32K148
    -D CPU_S32K148
    -D FEATURE_FLEXCAN

upload_protocol = jlink      ; J-Link programmer
debug_tool = jlink
monitor_speed = 115200

; ============================================================================
; Infineon AURIX TC375 - Advanced automotive (production-grade)
; ============================================================================
[env:aurix]
platform = infineon_aurix
board = tc375_lite           ; AURIX TC375 Lite Kit
board_build.mcu = TC375
board_build.f_cpu = 300000000L

lib_deps =
    ${env.lib_deps}
    ; AURIX iLLD library (MultiCAN)

build_flags =
    ${env.build_flags}
    -D MCU_PLATFORM=MCU_INFINEON_AURIX
    -D __TC37X__

upload_protocol = jlink
debug_tool = jlink
monitor_speed = 115200

; ============================================================================
; TI Hercules RM46 - Safety-critical (ASIL-D capable)
; ============================================================================
[env:hercules]
platform = titiva            ; TI TIVA platform (closest match)
board = ek-tm4c1294xl         ; Placeholder - use custom board config
board_build.mcu = RM46L852
board_build.f_cpu = 220000000L

lib_deps =
    ${env.lib_deps}
    ; Hercules HAL CAN library

build_flags =
    ${env.build_flags}
    -D MCU_PLATFORM=MCU_TI_HERCULES
    -D __RM46L852__

upload_protocol = xds110
debug_tool = xds110
monitor_speed = 115200
